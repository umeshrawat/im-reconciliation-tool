import chromadb
from chromadb.config import Settings

# Initialize ChromaDB client and collection
client = chromadb.Client(Settings(
    persist_directory="rag/chroma_db"  # Directory to store the DB files
))
collection = client.get_or_create_collection("im_reconciliation")

def add_document(doc_id: str, content: str, metadata: dict = None):
    """Add a document with optional metadata to the vector store."""
    collection.add(
        documents=[content],
        ids=[doc_id],
        metadatas=[metadata or {}]
    )

def query_documents(query_text: str, n_results: int = 5):
    """Query the vector store for similar documents."""
    results = collection.query(
        query_texts=[query_text],
        n_results=n_results
    )
    return results

def persist():
    """Persist the database to disk."""
    client.persist()